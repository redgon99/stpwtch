<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>고급현장지휘관 실기평가표</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        padding-top: 60px;
        /* 고정 헤더를 위한 상단 여백 추가 */
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        margin-top: 20px;
      }

      th,
      td {
        border: 1px solid black;
        padding: 8px;
        text-align: center;
      }

      th {
        background-color: #f2f2f2;
      }

      td.reference-cell {
        text-align: left;
        white-space: normal;
      }

      td.clickable {
        cursor: pointer;
      }

      td.selected {
        background-color: #c3c3c3;
        /* 셀 선택 시 배경 */
      }

      td.action-highlight {
        background-color: #e6e6e6;
        /* 행동지표 셀 강조 */
      }

      .highlight {
        background-color: yellow;
        font-weight: bold;
      }

      #resetButton {
        position: fixed;
        top: 10px;
        right: 10px;
        padding: 10px 20px;
        font-size: 1rem;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        background-color: #61dafb;
        color: #282c34;
        z-index: 901;
      }

      #refButton {
        position: fixed;
        top: 10px;
        right: 80px;
        padding: 10px 20px;
        font-size: 1rem;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        background-color: #7af880;
        color: #282c34;
        z-index: 901;
      }

      #resetButton:hover {
        background-color: #ffe7d9;
      }

      td.orange-bg {
        background-color: #ffe7d9;
        /* 배점 10점 셀의 배경색 */
      }

      h1 {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background-color: white;
        margin: 0;
        padding: 15px;
        text-align: center;
        z-index: 900;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .hide {
        display: none;
      }

      /* Footer Styles */
      footer {
        background-color: #f8f9fa;
        padding: 20px 0;
        margin-top: 40px;
        border-top: 1px solid #ddd;
      }

      .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        text-align: center;
      }

      .footer-info p {
        margin: 5px 0;
        color: #666;
        font-size: 0.9rem;
      }

      .footer-bottom {
        margin-top: 20px;
        text-align: center;
        color: #888;
        font-size: 0.8rem;
      }

      /* 햄버거 메뉴 스타일 수정 */
      .hamburger-menu {
        position: fixed;
        top: 20px;
        left: 20px;
        cursor: pointer;
        z-index: 901;
        width: 30px;
        height: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #f8f9fa;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      /* 햄버거 메뉴 라인 스타일 수정 */
      .hamburger-menu div {
        width: 20px;
        height: 2px;
        background-color: #333;
        position: absolute;
        transition: 0.3s;
      }

      .line1 {
        transform: translateY(-6px);
      }

      .line2 {
        opacity: 1;
      }

      .line3 {
        transform: translateY(6px);
      }

      /* 활성화 상태 스타일 수정 */
      .hamburger-menu.active .line1 {
        transform: rotate(45deg);
      }

      .hamburger-menu.active .line2 {
        opacity: 0;
      }

      .hamburger-menu.active .line3 {
        transform: rotate(-45deg);
      }

      /* 사이드바 스타일 수정 */
      .sidebar {
        display: none;
        position: fixed;
        left: -250px;
        top: 0;
        width: 250px;
        height: 100%;
        background-color: #f8f9fa;
        transition: 0.3s;
        padding: 60px 20px 20px;
        box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        z-index: 999;
      }

      .sidebar.active {
        display: block;
        left: 0;
      }

      /* 사이드바 메뉴 항목 스타일 */
      .sidebar ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .sidebar ul li {
        padding: 15px 0;
        border-bottom: 1px solid #ddd;
      }

      .sidebar ul li:last-child {
        border-bottom: none;
      }

      .sidebar ul li a {
        color: #333;
        text-decoration: none;
        font-size: 1rem;
        display: block;
        transition: 0.3s;
      }

      .sidebar ul li a:hover {
        color: #007bff;
        padding-left: 10px;
      }

      /* QR 코드 버튼 스타일 */
      /* #qrButton {
        position: fixed;
        top: 10px;
        right: 150px;
        padding: 10px 20px;
        font-size: 1rem;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        background-color: #f8f9fa;
        color: #282c34;
        z-index: 901;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        #qrButton:hover {
            background-color: #e9ecef;
        }
        */
    </style>
    <!-- Font Awesome CDN 추가 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>

  <body>
    <h1>
      고급 실기평가표
      <span>(총점: <span id="headerTotal">0/0점</span>, <span id="headerChecked">0/0</span>)</span>
    </h1>
    <button id="resetButton" title="초기화">
      <i class="fas fa-redo"></i>
    </button>
    <button id="refButton" title="참고사항 숨기기">
      <i class="fas fa-eye"></i>
    </button>
    <div class="hamburger-menu">
      <div class="line1"></div>
      <div class="line2"></div>
      <div class="line3"></div>
    </div>
    <div class="sidebar">
      <ul>
        <li>
          <a href="index.html">스탑워치&응시번호</a>
        </li>
        <li>
          <a href="est1.html">초급평가표</a>
        </li>
        <li>
          <a href="est2.html">중급평가표</a>
        </li>
        <li>
          <a href="est3.html">고급평가표</a>
        </li>
      </ul>
    </div>
    <table id="evaluationTable">
      <thead>
        <tr>
          <th>평가항목</th>
          <th>행동지표</th>
          <th>배점</th>
          <th>상</th>
          <th>중</th>
          <th>하</th>
          <th>참고사항</th>
        </tr>
      </thead>
      <tbody>
        <!-- Table rows dynamically populated -->
      </tbody>
      <tfoot>
        <tr>
          <td colspan="7">
            총합: <span id="total" class="highlight">0/0점</span>, 체크항목수: <span id="checkedCount">0/0</span>
          </td>
        </tr>
      </tfoot>
    </table>

    <script>
      // Evaluation Data - 고급평가표 데이터
      const evaluationData = [
        {
          항목: "상황평가 <br>및 의사결정",
          행동지표: "출동중 정보수집 및 선착대장 지원",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "상황실, 선착대장과 무전을 통해 정보파악 및 상황판작성<br>상황을 추정하고 대응활동 구상 및 선착대장에게 전파",
        },
        {
          항목: "상황평가 <br>및 의사결정",
          행동지표: "지휘권 선언",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "상황평가(육안) → 브리핑 → 지휘권 선언 → 상세상황평가<br>급박한 경우 도착 즉시 지휘선언 가능.",
        },
        {
          항목: "상황평가 <br>및 의사결정",
          행동지표: "최초 상황평가",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "ABCD, 둘러보는 상황평가(구조대상자+화재+연소확대 예측)<br>중요정보 및 활동파악(내부+외부), 추가소방력 요청<br>고정지휘(적정위치), 전략선택(공격전략), 핵심목표까지",
        },
        {
          항목: "상황평가 <br>및 의사결정",
          행동지표: "핵심목표(대응지침) 제시",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "상황평가와 위험성판단을 근거로 핵심목표 제시<br>(2층 노래방의 인명구조에 집중할 것), 상황변화시 변경가능",
        },
        {
          항목: "상황평가 <br>및 의사결정",
          행동지표: "1차 출동대 임무지시 및 조정",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "임무대기 무전시 바로 중요사항에 우선적으로 배치<br>(전술우선순위 기반 구체적 임무지시) 상황변화시 임무조정",
        },
        {
          항목: "상황평가 <br>및 의사결정",
          행동지표: "유관기관 등 추가자원 동원",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "최초 상황평가때 요청(특수차량 + 유관기관)<br>교대소방력을 고려한 충분한 자원 요청(필요시 대응단계)",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "차량배치 및 조정",
          배점: 3,
          상: 3,
          중: 2,
          하: 1,
          참고사항: "대기1단계(회차가능 적절부서), 대기2단계(자원대기소) 운영<br>특수차 공간확보, 1선펌프차, 중요물탱크 지정하는지",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "소방활동구역 설정 및 통제",
          배점: 3,
          상: 3,
          중: 2,
          하: 1,
          참고사항: "통제선 설치, 1통제선(소방), 2통제선(경찰)",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "소방용수공급체계 구축",
          배점: 3,
          상: 3,
          중: 2,
          하: 1,
          참고사항: "소화전, 1선펌프, 중요물탱크 - 급수체계 확보지시<br>인근에 소화전이 없는 경우 물탱크차 순환보수 전술",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "소방력 배치 및 조정",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "3단계 소방력 배치 모델 적용여부(위험구역 우선배치)<br>상황변화에 따라 배치 조정",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "현장분할 및 단위지휘관 운영",
          배점: 3,
          상: 3,
          중: 2,
          하: 1,
          참고사항: "지리적(2층), 기능적(임무) 분할 단위지휘관 운영<br>(단위지휘관과 무선교신 우선 원칙)",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "진행상황 파악 및 개선조치",
          배점: 10,
          상: 10,
          중: 7,
          하: 4,
          참고사항: "구역별로 핵심목표 달성여부, 대응 적절성 평가<br>악화 시 조정 및 대안마련 (추가인력, 폼.포사용 등)",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "전술우선순위 관리",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "생명보호 > 외부연소확대 방지 > 내부연소확대 방지 > 화점진화 > 2차 인명검색 잔화정리 등",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "완진절차 준수",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "단위대 상황보고> 현장지휘관 현장확인> 상황판단회의> 완진 건의<br>(통제단장의 완진 선언)",
        },
        {
          항목: "대응활동 <br>및 진행상황관리	",
          행동지표: "전술상황판 기록",
          배점: 3,
          상: 3,
          중: 2,
          하: 1,
          참고사항: "자원배치 관리, 화점, 구조대상자, 중요 위험요인<br>전술우선순위 달성 초진 및 완진",
        },
        {
          항목: "위기관리, 소통 및 리더쉽",
          행동지표: "무전통제",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "무전폭주시 무선침묵 지시로 통제 (무전 유지.통제)",
        },
        {
          항목: "위기관리, 소통 및 리더쉽",
          행동지표: "효율적인 의사교환",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "지시보다는 듣기에 비중을 두고 무전운용<br>명확하고 정확한 의사전달이 되는지",
        },
        {
          항목: "위기관리, 소통 및 리더쉽",
          행동지표: "돌발 및 위기상황 대응",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "돌발이나 위기에 적합한 지시를 하는지<br>소방차량고장, 통신장애, 주민항의, 폭발, 대원고립 등",
        },
        {
          항목: "위기관리, 소통 및 리더쉽",
          행동지표: "작전운영의 적절성",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "전술우선순위, 단위지휘관 운영, 자원배치 및 관리 등",
        },
        {
          항목: "위기관리, 소통 및 리더쉽",
          행동지표: "인명구조 목표달성 및 대원안전관리",
          배점: 10,
          상: 10,
          중: 7,
          하: 4,
          참고사항: "인명구조 최우선 여부, 활동 적절성<br>인명검색 절차 [우선탐색(발화점-발화층-직상층) + 교차탐색+정밀탐색]<br>구조대상자 발견시 이송 및 추가 인명검색의 연속성 유지",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "정확한 상황인식",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "재난상황(화재+확대+인명+위험요소)에 대한 인식",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "목표 및 우선순위 선정의 적절성",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "목표 및 해결할 문제에 대한 우선순위(RECEO) 적절성",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "최종계획의 구체성 및 우수성",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "문제해결을 위한 대응계획의 구체성+현실성+적합성",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "예비방안(대안) 제시",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "문제해결이 안될 경우를 가정한 대안을 제시하는지",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "시민생활 영향성 검토 및 반영",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "자력대피자 유도 및 환자파악 조치, 미대피인원 파악<br>일반시민의 피해·영향 우려 시 조치(주변 건물 대피조치 등)",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "상황판단회의 진행의 적절성",
          배점: 10,
          상: 10,
          중: 7,
          하: 4,
          참고사항: "현재의 문제점, 목표, 해결방안제시의 적절성<br>통제단 각 부의 임무를 숙지하고, 적절하고 구체적으로 요청",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "출동대 및 유관기관 간 업무조정",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "유관기관에 적절한 임무요청, 유관기관의 업무조정 능력",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "명확한 회의 결과 도출 및 지시",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "회의 결과 도출 및 회의 결과를 반영한 적절한 지휘 여부",
        },
        {
          항목: "대응활동계획 및 상황판단회의",
          행동지표: "대응활동계획 조정",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "돌발상황. 상황변화에 따른 대응활동계획 조정 능력<br>(폭발, 대원부상, 내부진입 거부, 각 부에서 어려움 호소 등)",
        },
        {
          항목: "언론브리핑",
          행동지표: "브리핑 준비",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "상황판 작성 적절성, 주변통제, 자료의 정확성 등",
        },
        {
          항목: "언론브리핑",
          행동지표: "브리핑 내용의 적절성",
          배점: 10,
          상: 10,
          중: 7,
          하: 4,
          참고사항: "소개 > 유감표명 > 개요(사고일시 및 장소, 유형) > 초기상황 > 활동사항(화재+인명) > 자원(소방+유관기관) > 다음 브리핑예정<br>★정보의 사실성, 사고원인 확정(X), 개인정보제공(X), 개인의견(X), 다른기관의 권한 및 책임언급(X), 인피는 변동가능성이 있음을 공지",
        },
        {
          항목: "언론브리핑",
          행동지표: "브리핑 태도",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "브리핑 시 태도(자세, 공손함, 자신감) 및 용어 사용의 적절성",
        },
        {
          항목: "언론브리핑",
          행동지표: "전달력",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "브리핑 내용의 이해가 쉬운지 (일반인의 입장에서)",
        },
        {
          항목: "언론브리핑",
          행동지표: "질의 응답의 적절성",
          배점: 10,
          상: 10,
          중: 7,
          하: 4,
          참고사항: "기자 질의에 대한 적절한 응답, 자신감+사실 기반<br>★정보의 사실성, 사고원인 확정(X), 개인정보제공(X), 개인의견(X)<br>다른기관의 권한 및 책임언급(X), 자세한 인피사항은 보건소장",
        },
        {
          항목: "언론브리핑",
          행동지표: "질문의 이해도",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "기자 질의 내용에 대한 이해 (난해한 질문 시 재확인 하는지)",
        },
        {
          항목: "언론브리핑",
          행동지표: "답변태도",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "답변 시 태도(자세+공손함+자신감) 및 용어 사용의 적절성",
        },
        {
          항목: "언론브리핑",
          행동지표: "언론취재의 방향성 제시",
          배점: 5,
          상: 5,
          중: 3,
          하: 1,
          참고사항: "사실+배경+수행임무+구체적 수치 제공+중립성+비난금지★",
        },
      ];

      const tbody = document.querySelector("tbody");
      const totalSpan = document.getElementById("total");
      const headerTotalSpan = document.getElementById("headerTotal");
      const checkedCountSpan = document.getElementById("checkedCount");
      const headerCheckedSpan = document.getElementById("headerChecked");
      let totalScore = 0;
      let checkedCount = 0;
      
      // 전체 항목 수 및 만점 계산
      const totalItems = evaluationData.length;
      const maxScore = evaluationData.reduce((sum, item) => sum + item.배점, 0);

      // localStorage 키 상수
      const STORAGE_KEY = "evaluation_data_advanced";
      const TOTAL_SCORE_KEY = "total_score_advanced";

      // 저장된 데이터 불러오기
      function loadSavedData() {
        const savedData = localStorage.getItem(STORAGE_KEY);
        const savedTotalScore = localStorage.getItem(TOTAL_SCORE_KEY);

        if (savedData) {
          const selectedCells = JSON.parse(savedData);
          selectedCells.forEach((cellData) => {
            const row = tbody.children[cellData.rowIndex];
            if (row) {
              const cell = row.children[cellData.cellIndex];
              const actionCell = row.querySelector(".action-cell");

              if (cell && actionCell) {
                cell.classList.add("selected");
                cell.textContent = cell.getAttribute("data-value");
                actionCell.classList.add("action-highlight");
              }
            }
          });
        }

        if (savedTotalScore) {
          totalScore = parseInt(savedTotalScore);
          // 체크된 항목 수 계산 (선택된 행의 수)
          checkedCount = Array.from(tbody.children).filter(row => 
            row.querySelector(".selected") !== null
          ).length;
          totalSpan.textContent = `${totalScore}/${maxScore}점`;
          headerTotalSpan.textContent = `${totalScore}/${maxScore}점`;
          checkedCountSpan.textContent = `${checkedCount}/${totalItems}`;
          headerCheckedSpan.textContent = `${checkedCount}/${totalItems}`;
        } else {
          // 초기 표시
          totalSpan.textContent = `0/${maxScore}점`;
          headerTotalSpan.textContent = `0/${maxScore}점`;
          checkedCountSpan.textContent = `0/${totalItems}`;
          headerCheckedSpan.textContent = `0/${totalItems}`;
        }
      }

      // 데이터 저장하기
      function saveData() {
        const selectedCells = [];
        document.querySelectorAll(".selected").forEach((cell) => {
          const row = cell.parentElement;
          const rowIndex = Array.from(tbody.children).indexOf(row);
          const cellIndex = Array.from(row.children).indexOf(cell);
          selectedCells.push({ rowIndex, cellIndex });
        });

        localStorage.setItem(STORAGE_KEY, JSON.stringify(selectedCells));
        localStorage.setItem(TOTAL_SCORE_KEY, totalScore.toString());
      }

      // Group rows by 항목 for rowspan logic
      function groupRowsByColumn(data, column) {
        const grouped = [];
        let currentGroup = { key: null, rows: [] };

        data.forEach((row) => {
          if (row[column] === currentGroup.key) {
            currentGroup.rows.push(row);
          } else {
            if (currentGroup.rows.length > 0) {
              grouped.push(currentGroup);
            }
            currentGroup = { key: row[column], rows: [row] };
          }
        });

        if (currentGroup.rows.length > 0) {
          grouped.push(currentGroup);
        }

        return grouped;
      }

      // Populate table rows with merged cells for 평가항목
      const groupedData = groupRowsByColumn(evaluationData, "항목");

      groupedData.forEach((group) => {
        const { key, rows } = group;

        rows.forEach((data, index) => {
          const row = document.createElement("tr");

          // Merge the first cell for 평가항목
          if (index === 0) {
            row.innerHTML = `
                        <td rowspan="${rows.length}">${key}</td>
                        <td class="action-cell">${data.행동지표}</td>
                        <td>${data.배점}</td>
                        <td class="clickable" data-value="${data.상}" data-row="${index}"></td>
                        <td class="clickable" data-value="${data.중}" data-row="${index}"></td>
                        <td class="clickable" data-value="${data.하}" data-row="${index}"></td>
                        <td class="reference-cell">${data.참고사항}</td>
                    `;
          } else {
            row.innerHTML = `
                        <td class="action-cell">${data.행동지표}</td>
                        <td>${data.배점}</td>
                        <td class="clickable" data-value="${data.상}" data-row="${index}"></td>
                        <td class="clickable" data-value="${data.중}" data-row="${index}"></td>
                        <td class="clickable" data-value="${data.하}" data-row="${index}"></td>
                        <td class="reference-cell">${data.참고사항}</td>
                    `;
          }

          tbody.appendChild(row);
        });
      });

      // Add click event listener to tbody
      tbody.addEventListener("click", (event) => {
        const cell = event.target;

        if (cell.classList.contains("clickable")) {
          const row = cell.parentElement; // 현재 셀이 속한 행
          const actionCell = row.querySelector(".action-cell"); // 행동지표 셀
          const rowCells = Array.from(row.children).filter((c) =>
            c.classList.contains("clickable")
          );

          // Deselect other cells in the same row
          rowCells.forEach((c) => {
            if (c !== cell && c.classList.contains("selected")) {
              totalScore -= parseInt(c.getAttribute("data-value"), 10);
              c.classList.remove("selected");
              c.textContent = ""; // 값 초기화
            }
          });

          // Toggle selection
          if (cell.classList.contains("selected")) {
            totalScore -= parseInt(cell.getAttribute("data-value"), 10);
            cell.classList.remove("selected");
            cell.textContent = ""; // 값 초기화
            actionCell.classList.remove("action-highlight"); // 행동지표 강조 제거
          } else {
            totalScore += parseInt(cell.getAttribute("data-value"), 10);
            cell.classList.add("selected");
            cell.textContent = cell.getAttribute("data-value"); // 선택된 값 표시
            actionCell.classList.add("action-highlight"); // 행동지표 강조
          }

      // 체크된 항목 수 계산 (선택된 행의 수)
      checkedCount = Array.from(tbody.children).filter(row => 
        row.querySelector(".selected") !== null
      ).length;
      
      // Update total score in both places
      totalSpan.textContent = `${totalScore}/${maxScore}점`;
      headerTotalSpan.textContent = `${totalScore}/${maxScore}점`;
      checkedCountSpan.textContent = `${checkedCount}/${totalItems}`;
      headerCheckedSpan.textContent = `${checkedCount}/${totalItems}`;

      // 데이터 저장
      saveData();
        }
      });

      // Reset functionality
      const resetButton = document.getElementById("resetButton");
      resetButton.addEventListener("click", () => {
        // Reset all selected cells
        document.querySelectorAll(".selected").forEach((cell) => {
          cell.classList.remove("selected");
          cell.textContent = ""; // 셀의 값을 공란으로 초기화
        });

        // Reset all highlighted 행동지표 cells
        document.querySelectorAll(".action-highlight").forEach((cell) => {
          cell.classList.remove("action-highlight");
        });

        // Reset total score in both places
        totalScore = 0;
        checkedCount = 0;
        totalSpan.textContent = `0/${maxScore}점`;
        headerTotalSpan.textContent = `0/${maxScore}점`;
        checkedCountSpan.textContent = `0/${totalItems}`;
        headerCheckedSpan.textContent = `0/${totalItems}`;

        // localStorage 데이터 삭제
        localStorage.removeItem(STORAGE_KEY);
        localStorage.removeItem(TOTAL_SCORE_KEY);
      });

      // 참고사항 버튼 클릭 이벤트 수정
      document.getElementById("refButton").addEventListener("click", () => {
        const icon = document.querySelector("#refButton i");
        const button = document.getElementById("refButton");

        // 아이콘과 툴팁 토글
        if (icon.classList.contains("fa-eye")) {
          icon.classList.replace("fa-eye", "fa-eye-slash");
          button.title = "참고사항 보기";
        } else {
          icon.classList.replace("fa-eye-slash", "fa-eye");
          button.title = "참고사항 숨기기";
        }

        // 참고사항 열 토글
        document
          .querySelectorAll("thead th:last-child, tbody td:last-child")
          .forEach((cell) => {
            cell.classList.toggle("hide");
          });
      });

      // 배점 10점 셀에 주황색 배경 추가
      document.querySelectorAll("tbody tr").forEach((row) => {
        // 각 행의 모든 열을 확인
        const cells = row.querySelectorAll("td");
        cells.forEach((cell, index) => {
          // 배점 열의 값을 확인
          if (parseInt(cell.textContent, 10) === 10) {
            cell.classList.add("orange-bg"); // 배점 셀에 주황색 클래스 추가

            // 왼쪽 셀 처리
            const previousCell = cell.previousElementSibling;
            if (previousCell) {
              previousCell.classList.add("orange-bg"); // 왼쪽 셀에 주황색 클래스 추가
            }
          }
        });
      });

      // 햄버거 메뉴 기능 수정
      const hamburger = document.querySelector(".hamburger-menu");
      const sidebar = document.querySelector(".sidebar");

      hamburger.addEventListener("click", () => {
        hamburger.classList.toggle("active");
        sidebar.classList.toggle("active");
      });

      // 사이드바 외부 클릭 시 닫기
      document.addEventListener("click", (e) => {
        if (!hamburger.contains(e.target) && !sidebar.contains(e.target)) {
          hamburger.classList.remove("active");
          sidebar.classList.remove("active");
        }
      });

      // 페이지 로드 시 저장된 데이터 불러오기
      document.addEventListener("DOMContentLoaded", loadSavedData);
    </script>

    <footer>
      <!-- <div class="footer-content">
        <div class="footer-info">
          <p>강원소방학교</p>
          <p>주소: 서울특별시 XX구 XX로 123</p>
          <p>전화: 02-1234-5678 | 팩스: 02-1234-5679</p>
          <p>이메일: training@fire.center.kr</p>
        </div>
      </div> -->
      <div class="footer-bottom">
        <p>&copy; 2025 강원소방학교 지휘역량강화센터 . All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>
